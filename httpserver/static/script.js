function hexToRgb(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function rgbToHex(e,t,a){return"#"+(1<<24|e<<16|t<<8|a).toString(16).slice(1)}PIXI.sound.add("MainMenuMusic",{url:"static\\mainMenuMusic.mp3",autoPlay:!0});let tree_size=new Map;function ZoomCorrection(){VIEW_X>0&&VIEW_Y>0&&(VIEW_X/VIEW_Y>GameW/GameH?Zoom<GameH/VIEW_Y/2&&(Zoom=GameH/VIEW_Y/2):Zoom<GameW/VIEW_X/2&&(Zoom=GameW/VIEW_X/2))}tree_size.set(0,.1),tree_size.set(1,.15),tree_size.set(2,.2),tree_size.set(3,.25),document.onkeydown=function(e){9!=e.keyCode&&112!=e.keyCode&&114!=e.keyCode||e.preventDefault()},document.getElementById("ServerAddress").value=document.getElementById("ServerSelect").value;let GameStatus="MainMenu",BGLayers=[[0,"../static/BG1/BG.svg"],[.0625,"../static/BG1/BG0.svg"],[.03125,"../static/BG1/BG1.svg"],[.015625,"../static/BG1/BG2.svg"],[.0078125,"../static/BG1/BG3.svg"],[-.00390625,"../static/BG1/BG4.svg"]];function UpdateBG(e){MainScreen.innerHTML="";for(let e=0;e<BGLayers.length;e++)MainScreen.innerHTML+='<div class="BGSVGLayer" id="SvgLayer'+e+'" style="background-image: url('+BGLayers[e][1]+');"></div>'}function forgetServer(){document.getElementById("online").innerHTML="?/?",document.getElementById("text").innerHTML="No information yet",document.getElementById("impprev").src=""}function onMouseUpdate(e){let t=e.pageX;for(let e=0;e<BGLayers.length;e++)document.getElementById("SvgLayer"+e).style.transform="translateX("+(t-window.innerWidth/2)*BGLayers[e][0]*1920/window.innerWidth+"px)"}function ExitGame(){Send=!0,messagebtn.innerText="Global",messageinput.value="/leave",setTimeout((function(){if("InGame"==GameStatus){GameStatus="MainMenu",PlayersData=new Map,PIXI.sound.play("MainMenuMusic");let e=document.getElementById("Inventory").children;for(let t=0;t<e.length;t++)e[t].style.display="";document.getElementById("chk-game").checked=!1,document.getElementById("chkInterfaceHide").checked=!1,chatview.innerHTML="",Players=[],socket.close()}}),500)}UpdateBG(),document.addEventListener("mousemove",onMouseUpdate,!1),document.addEventListener("mouseenter",onMouseUpdate,!1),window.onresize=resize;let ParticlesProcessing=!0;function ChSttSettings(){"none"==document.getElementById("SettingsForm").style.display?document.getElementById("SettingsForm").style.display="block":document.getElementById("SettingsForm").style.display="none"}function UpdtParticles(){ParticlesProcessing=document.getElementById("ParticlesChk").checked,localStorage.setItem("SettingsParticlesChkVal",document.getElementById("ParticlesChk").checked)}function UpdtVolumes(){let e=document.getElementById("VolumeRange").value,t=document.getElementById("MusicRange").value;localStorage.setItem("SettingsVolumeRangeVal",e),localStorage.setItem("SettingsMusicRangeVal",t),PIXI.sound.volume("MainMenuMusic",t),PIXI.sound.volumeAll=e}""!=localStorage.getItem("SettingsParticlesChkVal")&&null!=localStorage.getItem("SettingsParticlesChkVal")&&(ParticlesProcessing="true"==localStorage.getItem("SettingsParticlesChkVal")),document.getElementById("ParticlesChk").checked=ParticlesProcessing,document.getElementById("NameField").value=sessionStorage.getItem("NameFieldVal");var PlayerTags=new Map;function NoTeamTag(e,t=!1){if(null!=e)return e.split("]").length>1?(t&&PlayerTags.set(e.split("]")[1],e.split("]")[0].slice(1)),e.split("]")[1]):(t&&PlayerTags.set(e,null),e)}let GameH=0,GameW=0;PIXI.sound.add("bang","static\\bang.mp3"),PIXI.sound.add("wtrBang","static\\wtrBang.mp3"),PIXI.sound.add("lnchTrpd","static\\TorpedoLaunch.mp3"),PIXI.sound.add("lnchRckt","static\\RocketLaunch.mp3"),PIXI.sound.add("bombFall","static\\bombFall4s.mp3"),PIXI.sound.add("rocketHit","static\\rocketHit.mp3"),PIXI.sound.add("dmg0","static\\dmg\\0.mp3"),PIXI.sound.add("dmg1","static\\dmg\\1.mp3"),PIXI.sound.add("dmg2","static\\dmg\\2.mp3"),PIXI.sound.add("dmg3","static\\dmg\\3.mp3"),PIXI.sound.add("Sdmg0","static\\Sdmg\\0.mp3"),PIXI.sound.add("Sdmg1","static\\Sdmg\\1.mp3"),PIXI.sound.add("mcanon","static\\mcanon.mp3"),PIXI.sound.add("pcanon","static\\pcanon.mp3"),PIXI.sound.add("tcanon","static\\mcanon.mp3"),PIXI.sound.add("hcanon","static\\pcanon.mp3"),PIXI.sound.add("fcanon","static\\pcanon.mp3");var Vehicles,VehList,PlayerName,CurVehicle,cameraMode=!1,Players=[],TorpedosData=new Map,AARocketsData=new Map,BombsData=new Map,BulletsData=new Map,SmokesData=new Map,ColorPack="Summer",PlayersData=new Map,VIEW_X=0,VIEW_Y=0,Zones="",SelectedVehicleShopId=null;function onWheel(e){e.deltaY>0?Zoom-=10:Zoom+=10,Zoom>640&&(Zoom=640),ZoomCorrection()}function ShowPrevVeh(){sessionStorage.setItem("VehicleSelectVal",document.getElementById("VehicleSelect").value);for(let e of VehList)if(e[1]==document.getElementById("VehicleSelect").value){document.getElementById("vehprev").src=e[2],SelectedVehicleShopId=e[3];break}}function GetServerInfo(){try{let e=new WebSocket(document.getElementById("ServerAddress").value);e.addEventListener("open",(function(t){e.send("info")})),e.addEventListener("message",(function(e){var t=JSON.parse(e.data);document.getElementById("impprev").src=t.map,document.getElementById("Map").src=t.map,document.getElementById("online").innerHTML="Players: "+t.online,document.getElementById("text").innerHTML=t.text,document.getElementById("prevmpjs").src=t.js,BGLayers=t.bg,UpdateBG(),MainScreen.style.background=t.bg_cl,VIEW_X=t.VIEW_X,VIEW_Y=t.VIEW_Y,VehList=t.vehicleAvailable,document.getElementById("VehicleSelect").innerHTML="";let a=!0;for(let e of VehList)document.getElementById("VehicleSelect").innerHTML+='<option value = "'+e[1]+'">'+e[0]+"</option>",Number(e[1])==Number(sessionStorage.getItem("VehicleSelectVal"))&&(a=!1);a||""==sessionStorage.getItem("VehicleSelectVal")||null==sessionStorage.getItem("VehicleSelectVal")?document.getElementById("VehicleSelect").value=t.vehicleAvailable[0][1]:document.getElementById("VehicleSelect").value=sessionStorage.getItem("VehicleSelectVal"),ShowPrevVeh()}))}catch{document.getElementById("online").innerHTML="?/?",document.getElementById("text").innerHTML="No information yet",document.getElementById("impprev").src=""}}var MAPstatic={"*":[],B:[],Z:[],G:[],S:[],Q:[],_:[],CT:{weather:"Clear",sf:"#000",ss:"#000",bg:"#000",zs:"#000",zf:"#000",bf:"#000",bs:"#000",gf:"#000",gs:"#000",o0:"#000",o1:"#000",l0:"#000",l1:"#000",b0:"#000",b1:"#000",b2:"#000",fs:"rgba(0,0,0,0)",os:"rgba(0,0,0,0)"}};let Zoom=320,currentZoom=320,socket=null,curView=0,Xmod=!1,Cmod=!1,LoadScrHidn=!1,ShakeXbnds=0,ShakeYbnds=0,SENDB="",SENDS="",X=16,Y=16,nX=16,Z=0,speed=0,nY=16,Deg=0,newDeg=0,vehicle=0,WH=32,OffsetX=0,OffsetY=0;document.getElementById("VolumeRange").value=localStorage.getItem("SettingsVolumeRangeVal"),document.getElementById("MusicRange").value=localStorage.getItem("SettingsMusicRangeVal"),UpdtVolumes();let MSGTKNDT=new Date,FPS=30,PING=0,LastPING=Date.now(),Send=!1,hp=document.getElementById("HPNum"),ZonesNum=document.getElementById("Zones"),moneyb=document.getElementById("MoneyB"),gasnum=document.getElementById("GasNum"),spdnum=document.getElementById("SpdNum"),dirnum=document.getElementById("DirNum"),tornum=document.getElementById("TorNum"),aarnum=document.getElementById("AARocketNum"),bmbnum=document.getElementById("BombNum"),carrynum=document.getElementById("CarryNum"),smknum=document.getElementById("SmkNum"),tracernum=document.getElementById("TracerNum"),num120=document.getElementById("Num120"),num45=document.getElementById("Num45"),num20=document.getElementById("Num20"),num8=document.getElementById("Num8"),xmodnum=document.getElementById("XmodNum"),cmodnum=document.getElementById("CmodNum"),PlayerMark=document.getElementById("PlayerMark"),xnum=document.getElementById("XNum"),ynum=document.getElementById("YNum"),canvas=document.getElementById("MainCanvas"),chatview=document.getElementById("ChatView"),map=document.getElementById("MapForm"),mapimg=document.getElementById("Map"),tab=document.getElementById("TabForm"),moneys=document.getElementById("MoneyB"),nicknameinput=document.getElementById("NameField"),messageinput=document.getElementById("MessageFieldTxt");messageinput.onkeydown=function(e){9!=e.keyCode&&17!=e.keyCode||("Global"==messagebtn.innerText?messagebtn.innerText="Team":messagebtn.innerText="Global")};let messagefield=document.getElementById("MessageField"),messagebtn=document.getElementById("MessageFieldBtn"),mapimgwh=100,mapimgrect=null,ctx=canvas.getContext("2d");ctx.globalCompositeOperation="xor",resize();let BURNING=!1;WtrParticles0=[];let RainParticles0=[],RainParticles0max=500,SnowParticles0=[],SnowParticles0max=100,FireParticles0=[],FireParticles1=[],FireParticles2=[],RocketTraceParticles=[],CanBangParticles0=[],CanBangParticles1=[],FireParticles0max=20,FireParticles0speed=.25,FireParticles0size=3,WtrBangParticles0=[],BangParticles0=[],BangParticles1=[],BangParticles2=[],SmokeParticles0=[],SmokeParticles0rate=60,TracerParticles1=[];function changeColor(){sessionStorage.setItem("SelectedCL",document.querySelector('input[name="color"]:checked').value)}try{document.querySelector('input[name="color"][value="'+sessionStorage.getItem("SelectedCL")+'"]').checked=!0}catch{}let MSGs=[],ammo=new Map;ammo.set("120mm",0),ammo.set("45mm",0),ammo.set("20mm",0),ammo.set("8mm",0);let input=new Map;input.set(87,!1),input.set(65,!1),input.set(83,!1),input.set(68,!1),input.set(32,!1),input.set(71,!1),input.set("Tab",!1),input.set("m0",!1);let dobleinput=new Map;dobleinput.set(87,!1),dobleinput.set(65,!1),dobleinput.set(83,!1),dobleinput.set(68,!1),dobleinput.set(32,!1),dobleinput.set(71,!1),dobleinput.set("m0",!1);let mouseX=0,mouseY=0,INFO="",MAP=new Map;MAP.set("b",new Map),MAP.set("s",new Map),MAP.set("z",new Map),MAP.set("g",new Map);let lastMSGid=0;function startgame(){document.getElementById("chk-game").checked=!0,GameStatus="InGame",UpdateObjs=!0,PIXI.sound.stop("MainMenuMusic"),canvas.addEventListener("mousedown",mclick,!1),document.addEventListener("mouseup",mrelease,!1),document.addEventListener("mousemove",mousepos,!1),document.addEventListener("fullscreenchange",fresize),document.addEventListener("keydown",keydown),document.addEventListener("keyup",keyup),messagefield.addEventListener("focusout",mifo),document.addEventListener("wheel",onWheel);try{socket=new WebSocket(document.getElementById("ServerAddress").value),socket.addEventListener("open",(function(e){socket.send("n"+nicknameinput.value+"\n"+document.querySelector('input[name="color"]:checked').value+"\n"+document.getElementById("VehicleSelect").value+"\n"+document.getElementById("NICK").innerText+"\n"+document.getElementById("PASS").innerText),vehicle=Number(document.getElementById("VehicleSelect").value)})),socket.addEventListener("message",(function(e){lastMSGid=e.data.split(",")[0];let t=e.data.slice(lastMSGid.length+1,e.data.length);if(lastMSGid=Number(lastMSGid),"E"==t[0])GameStatus="Error",document.getElementById("TitleScreen").classList=["titlescrh"],document.getElementById("chkInterfaceHide").checked=!1,alert(t.split(",")[1]);else if("M"==t[0]){document.getElementById("TitleScreen").classList=["titlescrh"];var a=new XMLHttpRequest;a.open("GET",t.substring(1),!1),a.send(null),MAPstatic=JSON.parse(a.responseText);for(let e in MAPstatic["#"])for(let t in MAPstatic["#"][e])MAPstatic["#"][e][t].push(0);WH=MAPstatic.WH,ZonesNum.innerHTML="";for(let e=0;e<MAPstatic["*"].length;e++)ZonesNum.innerHTML+='<div class="Zone" style="background-color: red" id="zone'+e+'"><b>'+MAPstatic["*"][e][0]+"</b></div>";setTimeout((function(){UpdateObjs=!0}),300),socket.send((input.get("m0")||dobleinput.get("m0")?1:0).toString()+(input.get(87)||dobleinput.get(87)?1:0).toString()+(input.get(65)||dobleinput.get(65)?1:0).toString()+(input.get(83)||dobleinput.get(83)?1:0).toString()+(input.get(68)||dobleinput.get(68)?1:0).toString()+(input.get(32)||dobleinput.get(32)?1:0).toString()+(input.get(71)||dobleinput.get(71)?1:0).toString()+(input.get("Tab")?1:0).toString()+(Cmod?1:0).toString()+(Xmod?1:0).toString()+curView.toString()+((mouseX-GameW/2/window.devicePixelRatio)/Zoom).toString()+","+((mouseY-GameH/2/window.devicePixelRatio)/Zoom).toString())}else if("D"==t[0]){GameStatus="MainMenu",PlayersData=new Map,PIXI.sound.play("MainMenuMusic");let e=document.getElementById("Inventory").children;for(let t=0;t<e.length;t++)e[t].style.display="none";document.getElementById("chk-game").checked=!1,document.getElementById("chkInterfaceHide").checked=!1,chatview.innerHTML="",StartMainMusicPlay=Date.now(),Players=[],socket.close()}else if("R"==t[0])socket.close(),SaveMusicPos(),location.replace(e.data.slice(1));else{MSGTKNDT=new Date,INFO=t,PING=Date.now()-LastPING,LastPING=Date.now();let e=INFO.split("\n");Players=[],splstr=e[0].split(","),PlayerTags=new Map,PlayerName=splstr[1],CurVehicle=splstr[0],Money=splstr[2],Zones=splstr[splstr.length-1].toString();for(let e=0;e<Zones.length;e++){let t=document.getElementById("zone"+e.toString());"1"==Zones[e]?t.style.background="#44f":t.style.background="#f00"}argarr=[];for(let e=3;e<splstr.length;e++)argarr.push(splstr[e]);""!=PlayerName&&null!=PlayerName?(PlayerName=NoTeamTag(PlayerName,!0),Players.push([PlayerName,CurVehicle]),Vehicles[CurVehicle].updatep(PlayerName,argarr)):UpdateObjs=!0,null!=moneyb&&(moneyb.innerText=Money),PlayerMark.style.left=(X/WH*100).toString()+"%",PlayerMark.style.top=(Y/WH*100).toString()+"%",e[0].split(",")[6];for(let t=1;t<e.length;t++){let a=e[t].split(",");if("k"==a[0]){if(-1==MSGs.indexOf(Number(a[3]))){let e=document.createElement("div");e.className="MSGk",e.innerHTML="<b>"+a[1]+"</b> destroyed <b>"+a[2]+"</b>",chatview.append(e),MSGs.push(Number(a[3]))}}else if("l"==a[0]){if(-1==MSGs.indexOf(Number(a[2]))){let e=document.createElement("div");e.className="MSGl",e.innerHTML=a[1],chatview.append(e),MSGs.push(Number(a[2]))}}else if("+"==a[0]){PN=a[1],CV=a[2],argarr=[];for(let e=3;e<a.length;e++)argarr.push(a[e]);""!=PN&&null!=PN&&(Players.push([PN,CV]),Vehicles[CV].update(NoTeamTag(PN,!0),argarr))}else if("a"==a[0])ammo.set("120mm",Number(a[1])),ammo.set("45mm",Number(a[2])),ammo.set("20mm",Number(a[3])),ammo.set("8mm",Number(a[4])),num120.innerHTML="<span>120mm</span>"+a[1],num45.innerHTML="<span>45mm</span>"+a[2],num20.innerHTML="<span>20mm</span>"+a[3],num8.innerHTML="<span>8mm</span>"+a[4],"0"==a[1]?num120.className="unselectable ammonum NumAmmo0":num120.className="unselectable ammonum NumAmmo","0"==a[2]?num45.className="unselectable ammonum NumAmmo0":num45.className="unselectable ammonum NumAmmo","0"==a[3]?num20.className="unselectable ammonum NumAmmo0":num20.className="unselectable ammonum NumAmmo","0"==a[4]?num8.className="unselectable ammonum NumAmmo0":num8.className="unselectable ammonum NumAmmo";else if("g"==a[0]&&a.length>3){if(-1==MSGs.indexOf(Number(a[3]))){let e=document.createElement("div");e.className="crewMSG",e.innerHTML="<b>"+a[1]+"</b> "+a[2],chatview.append(e),e.scrollIntoView(),MSGs.push(Number(a[3]))}}else if("c"==a[0]){if(-1==MSGs.indexOf(Number(a[1])))if(0==Number(a[2])){let e=document.createElement("div");e.className="TeamMSG",e.innerHTML="Requested to join <b>"+a[3]+"</b>",chatview.append(e),MSGs.push(Number(a[1]))}else if("1"==a[2]){let e=document.createElement("div");e.className="ErrMSG",e.innerHTML="No such team !",chatview.append(e),MSGs.push(Number(a[1]))}else if("2"==a[2]){let e=document.createElement("div");e.className="ErrMSG",e.innerHTML="You are already in team, if you want to leave type <b>/team leave</b> !",chatview.append(e),MSGs.push(Number(a[1]))}else if("3"==a[2]){let e=document.createElement("div");e.className="ErrMSG",e.innerHTML="Team <b>"+a[3]+"</b> already exists !",chatview.append(e),MSGs.push(Number(a[1]))}else if("4"==a[2]){let e=document.createElement("div");e.className="TeamMSG",e.innerHTML="Team <b>"+a[3]+"</b> was successfully created !",chatview.append(e),MSGs.push(Number(a[1]))}else if("5"==a[2]){let e=document.createElement("div");e.className="ErrMSG",e.innerHTML="You are alone, you can't leave team !",chatview.append(e),MSGs.push(Number(a[1]))}else if("6"==a[2]){let e=document.createElement("div");e.className="ErrMSG",e.innerHTML="No permission to use this command !",chatview.append(e),MSGs.push(Number(a[1]))}else if("7"==a[2]){let e=document.createElement("div");e.className="ErrMSG",e.innerHTML="You can't kick yourself, use <b>/team leave</b> !",chatview.append(e),MSGs.push(Number(a[1]))}else if("8"==a[2]){let e=document.createElement("div");e.className="KickMSG",e.innerHTML="Player <b>"+a[3]+"</b> was kicked from team",chatview.append(e),MSGs.push(Number(a[1]))}else if("9"==a[2]){let e=document.createElement("div");e.className="KickMSG",e.innerHTML="Welcome the new team member <b>"+a[3]+"</b>",chatview.append(e),MSGs.push(Number(a[1]))}else if("a"==a[2]){let e=document.createElement("div");e.className="ErrMSG",e.innerHTML="You are alone, you have no teammates !",chatview.append(e),MSGs.push(Number(a[1]))}else if("b"==a[2]){let e=document.createElement("div");e.className="TeamMSG",e.innerHTML="You succesfully left team !",chatview.append(e),MSGs.push(Number(a[1]))}}else if("m"==a[0]){if(-1==MSGs.indexOf(Number(a[3]))){let e=document.createElement("div");"[SERVER]"==a[1]?e.className="ServerMSG":e.className="MSG",a[1].split("]").length>1&&"[SERVER]"!=a[1]?e.innerHTML="<b><a onclick=\"Send = true;messagebtn.innerText = 'Global'; messageinput.value = '/team join "+a[1].split("]")[0].slice(1)+"';\">["+a[1].split("]")[0].slice(1)+"]</a>"+a[1].split("]")[1]+"</b> "+a[2]:e.innerHTML="<b>"+a[1]+"</b> "+a[2],chatview.append(e),e.scrollIntoView(),MSGs.push(Number(a[3]))}}else if("#"==a[0])for(let e=2;e<a.length;e+=2)MAPstatic["#"][a[1]][a[e]][6]=a[e+1];else if("p"==a[0])if(a.length>3)SmokesData.has(a[1])||SmokesData.set(a[1],[Number(a[2]),Number(a[3]),Date.now(),!1,[]]);else try{SmokesData.get(a[1])[3]=!0}catch{}else if("b"==a[0])if(a.length>3)BombsData.has(a[1])||BombsData.set(a[1],[Number(a[2]),Number(a[3]),Number(a[4]),Number(a[5]),Number(a[6]),Number(a[7]),Date.now(),!1,Number(a[8])]);else try{BombsData.get(a[1])[4]=a[2],BombsData.get(a[1])[7]=!0}catch{}else if("r"==a[0])if(a.length>3)AARocketsData.has(a[1])||AARocketsData.set(a[1],[Number(a[2]),Number(a[3]),Number(a[4]),Number(a[5]),Number(a[6]),!1,Number(a[2])-Math.cos(Number(a[4])/180*Math.PI)*Number(a[6])*PING/1e3*3,Number(a[3])-Math.sin(Number(a[4])/180*Math.PI)*Number(a[6])*PING/1e3*3,Date.now()-1.5*PING,Number(a[7])]);else try{AARocketsData.get(a[1])[3]=a[2],AARocketsData.get(a[1])[5]=!0}catch{}else if("<"==a[0])if(a.length>3)TorpedosData.has(a[1])||TorpedosData.set(a[1],[Number(a[2]),Number(a[3]),Number(a[4]),Number(a[5]),Number(a[6]),!1,Number(a[2])-Math.cos(Number(a[4])/180*Math.PI)*Number(a[6])*PING/1e3*3,Number(a[3])-Math.sin(Number(a[4])/180*Math.PI)*Number(a[6])*PING/1e3*3,Date.now()]);else try{TorpedosData.get(a[1])[3]=a[2],TorpedosData.get(a[1])[5]=!0}catch{}else if(">"==a[0])if(a.length>3)BulletsData.has(a[1])||BulletsData.set(a[1],[Number(a[2]),Number(a[3]),Number(a[4]),Number(a[5]),Number(a[6]),Number(a[7]),Number(a[8]),!1,Number(a[2]),Number(a[3]),Date.now(),0]);else try{BulletsData.get(a[1])[3]=a[2],BulletsData.get(a[1])[7]=!0}catch{}else if("j"==a[0]){if(-1==MSGs.indexOf(Number(a[2]))){let e=document.createElement("div");e.className="MSGj",e.innerHTML='<img src="static/checkmark.svg" onclick="Send = true; messageinput.value = \'/team accept '+a[1]+"'; this.parentNode.remove()\">   "+a[1],chatview.append(e),e.scrollIntoView(),MSGs.push(Number(a[2]))}}else if("t"==a[0]){tab.innerHTML="";let e=document.createElement("table");for(let t=1;t<a.length;t+=2)a[t].split("]").length>1?e.innerHTML+='    <tr class="bg'+(t-1)/2%2+"\">\n        <td><b><a onclick=\"Send = true;messagebtn.innerText = 'Global'; messageinput.value = '/team join "+a[t].split("]")[0].slice(1)+"';\">["+a[t].split("]")[0].slice(1)+"]</a>"+a[t].split("]")[1]+'</b></td>\n        <td class="td2"><b>'+a[t+1]+"</b></td>\n    </tr>":e.innerHTML+='    <tr class="bg'+(t-1)/2%2+'">\n        <td><b>'+a[t]+'</b></td>\n        <td class="td2"><b>'+a[t+1]+"</b></td>\n    </tr>";tab.appendChild(e),input.set("Tab",!1)}}for(var[o,s]of(dellarr=[],PlayersData)){for(_ of(b=!0,Players))NoTeamTag(_[0])==o&&(b=!1);b&&dellarr.push(o)}for(;dellarr.length>0;)PlayersData.delete(dellarr[0]),dellarr.shift();1==Send?("Team"==messagebtn.innerText?socket.send(lastMSGid.toString()+","+(input.get("m0")||dobleinput.get("m0")?1:0).toString()+(input.get(87)||dobleinput.get(87)?1:0).toString()+(input.get(65)||dobleinput.get(65)?1:0).toString()+(input.get(83)||dobleinput.get(83)?1:0).toString()+(input.get(68)||dobleinput.get(68)?1:0).toString()+(input.get(32)||dobleinput.get(32)?1:0).toString()+(input.get(71)||dobleinput.get(71)?1:0).toString()+(input.get("Tab")?1:0).toString()+(Cmod?1:0).toString()+(Xmod?1:0).toString()+curView.toString()+((mouseX-GameW/2/window.devicePixelRatio)/Zoom).toString()+","+((mouseY-GameH/2/window.devicePixelRatio)/Zoom).toString()+",m/team chat "+messageinput.value):socket.send(lastMSGid.toString()+","+(input.get("m0")||dobleinput.get("m0")?1:0).toString()+(input.get(87)||dobleinput.get(87)?1:0).toString()+(input.get(65)||dobleinput.get(65)?1:0).toString()+(input.get(83)||dobleinput.get(83)?1:0).toString()+(input.get(68)||dobleinput.get(68)?1:0).toString()+(input.get(32)||dobleinput.get(32)?1:0).toString()+(input.get(71)||dobleinput.get(71)?1:0).toString()+(input.get("Tab")?1:0).toString()+(Cmod?1:0).toString()+(Xmod?1:0).toString()+curView.toString()+((mouseX-GameW/2/window.devicePixelRatio)/Zoom).toString()+","+((mouseY-GameH/2/window.devicePixelRatio)/Zoom).toString()+",m"+messageinput.value),messageinput.value="",Send=!1):socket.send(lastMSGid.toString()+","+(input.get("m0")||dobleinput.get("m0")?1:0).toString()+(input.get(87)||dobleinput.get(87)?1:0).toString()+(input.get(65)||dobleinput.get(65)?1:0).toString()+(input.get(83)||dobleinput.get(83)?1:0).toString()+(input.get(68)||dobleinput.get(68)?1:0).toString()+(input.get(32)||dobleinput.get(32)?1:0).toString()+(input.get(71)||dobleinput.get(71)?1:0).toString()+(input.get("Tab")?1:0).toString()+(Cmod?1:0).toString()+(Xmod?1:0).toString()+curView.toString()+((mouseX-GameW/2/window.devicePixelRatio)/Zoom*window.devicePixelRatio).toString()+","+((mouseY-GameH/2/window.devicePixelRatio)/Zoom*window.devicePixelRatio).toString()),SENDB="",SENDS="",dobleinput.set(87,!1),dobleinput.set(65,!1),dobleinput.set(83,!1),dobleinput.set(68,!1),dobleinput.set(32,!1),dobleinput.set(71,!1),dobleinput.set("m0",!1),input.set("Tab",!1)}})),socket.onerror=function(e){document.getElementById("TitleScreen").classList=["titlescrh"],document.getElementById("chkInterfaceHide").checked=!1}}catch(e){}}function lookat(e,t){0==e&&(e=.001);let a=Math.atan(t/e)/(Math.PI/180);return t!=Math.abs(t)&&(a+=360),e!=Math.abs(e)&&(a+=180),a-=360*Math.floor(a/360),a}function resize(){GameW=window.innerWidth*window.devicePixelRatio,GameH=window.innerHeight*window.devicePixelRatio,canvas.width=window.innerWidth*window.devicePixelRatio,canvas.height=window.innerHeight*window.devicePixelRatio,canvas.style.width=window.innerWidth+"px",canvas.style.height=window.innerHeight+"px",ZoomCorrection()}function fresize(){GameW=window.innerWidth*window.devicePixelRatio,GameH=window.innerHeight*window.devicePixelRatio,canvas.width=window.innerWidth*window.devicePixelRatio,canvas.height=window.innerHeight*window.devicePixelRatio,canvas.style.width=window.innerWidth+"px",canvas.style.height=window.innerHeight+"px",ZoomCorrection()}function mclick(){input.set("m0",!0),dobleinput.set("m0",!0)}function mrelease(){input.set("m0",!1)}function mifo(){messagefield.style.display="none"}function keydown(e){"none"!=messagefield.style.display||87!=e.keyCode&&65!=e.keyCode&&83!=e.keyCode&&68!=e.keyCode&&32!=e.keyCode&&71!=e.keyCode?"Enter"==e.key&&"InGame"==GameStatus?"none"==messagefield.style.display?(messagefield.style.display="block",messageinput.focus()):(messagefield.style.display="none",Send=!0):113==e.keyCode?(document.getElementById("chkInterfaceHide").checked=!document.getElementById("chkInterfaceHide").checked,cameraMode=document.getElementById("chkInterfaceHide").checked):114==e.keyCode?"crosshair"==document.getElementById("MainCanvas").style.cursor?document.getElementById("MainCanvas").style.cursor="none":document.getElementById("MainCanvas").style.cursor="crosshair":86==e.keyCode?(curView=(curView+1)%Vehicles[CurVehicle].views,document.getElementById("ViewImg").src=Vehicles[CurVehicle].viewsIcons[curView]):"none"==messagefield.style.display&&77==e.keyCode?map.style.display="block":"none"==messagefield.style.display&&9==e.keyCode?(input.set("Tab",!0),tab.style.display="block"):"none"==messagefield.style.display&&67==e.keyCode?(Cmod=!Cmod,cmodnum.src="./static/Cmodinv"+(Cmod?1:0).toString()+".svg",tracernum.src="./static/Tracerinv"+(Cmod?1:0).toString()+".svg"):"none"==messagefield.style.display&&88==e.keyCode&&(Xmod=!Xmod,xmodnum.src="./static/Xmodinv"+(Xmod?1:0).toString()+".svg"):(input.set(e.keyCode,!0),dobleinput.set(e.keyCode,!0))}function keyup(e){87==e.keyCode||65==e.keyCode||83==e.keyCode||68==e.keyCode||32==e.keyCode||71==e.keyCode?input.set(e.keyCode,!1):77==e.keyCode?map.style.display="none":9==e.keyCode&&(tab.style.display="none")}let start=null,timenow=Date.now(),VisibleObjs=new Object,UpdateObjs=!0,QupdtSequence=0;function DRAW(e){try{if("InGame"==GameStatus)if("Snow"==MAPstatic.CT.weather){if(0==SnowParticles0.length)for(var t=0;t<SnowParticles0max;t++)SnowParticles0.push(new Particle2(canvas.width,canvas.height))}else SnowParticles0.length>0&&(SnowParticles0=[]);else RainParticles0.length>0&&(RainParticles0=[]);timenow=Date.now(),BURNING&&(ShakeXbnds+=.25,ShakeYbnds+=.25),ShakeXbnds*=.9,ShakeYbnds*=.9,OffsetX=Math.random()*ShakeXbnds-ShakeXbnds/2,OffsetY=Math.random()*ShakeYbnds-ShakeYbnds/2,LastFPS=Date.now(),FPS=1e3/(Date.now()-LastAnime),LastAnime=Date.now(),start||(start=e);if(ctx.clearRect(0,0,canvas.width,canvas.height),ctx.fillStyle=MAPstatic.CT.bg,ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fill(),"InGame"==GameStatus){if((Math.round(X)!=Math.round(nX)||Math.round(Y)!=Math.round(nY))&&QupdtSequence!=X*nX+Y*nY||UpdateObjs){VisibleObjs=new Object,UpdateObjs=!1;for(let e=Math.round(X)-VIEW_X-2;e<Math.round(X)+VIEW_X+2;e++)for(let t=Math.round(Y)-VIEW_Y-2;t<Math.round(Y)+VIEW_Y+2;t++){if(e<0||t<0||e>=WH||t>=WH)continue;let a=MAPstatic.Q[e][t];q_keys=Object.keys(a);for(let a in q_keys){q_keys[a]in VisibleObjs||(VisibleObjs[q_keys[a]]=new Set);for(let o of MAPstatic.Q[e][t][q_keys[a]])VisibleObjs[q_keys[a]].add(o)}}QupdtSequence=X*nX+Y*nY}for(let e of VisibleObjs.B){let t=MAPstatic.B[e];ctx.strokeStyle=MAPstatic.CT.zs,ctx.lineJoin="bevel",ctx.beginPath(),ctx.lineWidth=.5*Zoom;for(let e=0;e<t.length;e+=1)0==e?ctx.moveTo(GameW/2+OffsetX-(X-t[0][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[0][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom):ctx.lineTo(GameW/2+OffsetX-(X-t[e][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[e][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom);ctx.closePath(),ctx.stroke()}for(let e of VisibleObjs.S){let t=MAPstatic.S[e];ctx.strokeStyle=MAPstatic.CT.zs,ctx.lineJoin="bevel",ctx.beginPath(),ctx.lineWidth=.25*Zoom;for(let e=0;e<t.length;e+=1)0==e?ctx.moveTo(GameW/2+OffsetX-(X-t[0][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[0][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom):ctx.lineTo(GameW/2+OffsetX-(X-t[e][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[e][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom);ctx.closePath(),ctx.stroke()}for(let e of VisibleObjs.C){let t=MAPstatic.C[e];ctx.strokeStyle=MAPstatic.CT.zs,ctx.lineJoin="bevel",ctx.beginPath(),ctx.lineWidth=.1875*Zoom;for(let e=0;e<t.length;e+=1)0==e?ctx.moveTo(GameW/2+OffsetX-(X-t[0][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[0][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom):ctx.lineTo(GameW/2+OffsetX-(X-t[e][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[e][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom);ctx.closePath(),ctx.stroke()}for(let e of VisibleObjs.B){let t=MAPstatic.B[e];ctx.strokeStyle=MAPstatic.CT.zf,ctx.lineJoin="bevel",ctx.beginPath(),ctx.lineWidth=.25*Zoom;for(let e=0;e<t.length;e+=1)0==e?ctx.moveTo(GameW/2+OffsetX-(X-t[0][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[0][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom):ctx.lineTo(GameW/2+OffsetX-(X-t[e][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[e][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom);ctx.closePath(),ctx.stroke()}for(let e of VisibleObjs.S){let t=MAPstatic.S[e];ctx.strokeStyle=MAPstatic.CT.zf,ctx.lineJoin="bevel",ctx.beginPath(),ctx.lineWidth=.125*Zoom;for(let e=0;e<t.length;e+=1)0==e?ctx.moveTo(GameW/2+OffsetX-(X-t[0][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[0][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom):ctx.lineTo(GameW/2+OffsetX-(X-t[e][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[e][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom);ctx.closePath(),ctx.stroke()}for(let e of VisibleObjs.C){let t=MAPstatic.C[e];ctx.strokeStyle=MAPstatic.CT.zf,ctx.lineJoin="bevel",ctx.beginPath(),ctx.lineWidth=30/320*Zoom;for(let e=0;e<t.length;e+=1)0==e?ctx.moveTo(GameW/2+OffsetX-(X-t[0][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[0][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom):ctx.lineTo(GameW/2+OffsetX-(X-t[e][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[e][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom);ctx.closePath(),ctx.stroke()}for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("UnderWater-2",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("UnderWater-2",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("UnderWater-1",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("UnderWater-1",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("UnderWater",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("UnderWater",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("UnderWater+1",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("UnderWater+1",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("UnderWater+2",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("UnderWater+2",NoTeamTag(Players[e][0]));if(ParticlesProcessing)for(t=0;t<WtrParticles0.length;t++)ctx.fillStyle="rgba(255,255,255,"+WtrParticles0[t].life**1.5*.25+")",ctx.beginPath(),ctx.arc(OffsetX+(WtrParticles0[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2,OffsetY+GameH/2+(WtrParticles0[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom,((WtrParticles0[t].rad-WtrParticles0[t].life*WtrParticles0[t].rad)/320*Zoom*7.5+2.5)/320*Zoom,0,2*Math.PI),ctx.fill(),WtrParticles0[t].life*=.99,WtrParticles0[t].life<.15&&(WtrParticles0.splice(t,1),t--);else WtrParticles0=[];for(let e of TorpedosData.keys()){if(1==TorpedosData.get(e)[3]){TorpedosData.get(e)[3]=0,PIXI.sound.play("wtrBang");for(let t=0;t<5;t++)WtrBangParticles0.push(new BangPrt0(TorpedosData.get(e)[0],TorpedosData.get(e)[1]));ShakeXbnds+=10,ShakeYbnds+=10}else 2==TorpedosData.get(e)[3]&&(PIXI.sound.play("lnchTrpd"),TorpedosData.get(e)[3]=0);grad=ctx.createLinearGradient(GameW/2+OffsetX-(X-TorpedosData.get(e)[0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-TorpedosData.get(e)[1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom,GameW/2+OffsetX-(X-TorpedosData.get(e)[0]+Math.cos(TorpedosData.get(e)[2]/180*Math.PI)*TorpedosData.get(e)[4]/3+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-TorpedosData.get(e)[1]+Math.sin(TorpedosData.get(e)[2]/180*Math.PI)*TorpedosData.get(e)[4]/3+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),Math.random()<.15&&WtrParticles0.push(new WtrPrt0(TorpedosData.get(e)[0],TorpedosData.get(e)[1])),grad.addColorStop(1,"#FFFFFF00"),grad.addColorStop(0,"#FFFFff88"),ctx.strokeStyle=grad,ctx.lineWidth=.025*Zoom,ctx.beginPath(),ctx.lineCap="round",ctx.moveTo(GameW/2+OffsetX-(X-TorpedosData.get(e)[0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-TorpedosData.get(e)[1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.lineTo(GameW/2+OffsetX-(X-TorpedosData.get(e)[0]+Math.cos(TorpedosData.get(e)[2]/180*Math.PI)*TorpedosData.get(e)[4]/3/320*Zoom+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-TorpedosData.get(e)[1]+Math.sin(TorpedosData.get(e)[2]/180*Math.PI)*TorpedosData.get(e)[4]/3/320*Zoom+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.stroke(),ctx.closePath(),TorpedosData.get(e)[0]=TorpedosData.get(e)[6]+Math.cos(TorpedosData.get(e)[2]/180*Math.PI)*TorpedosData.get(e)[4]*(Date.now()-TorpedosData.get(e)[8])/1e3,TorpedosData.get(e)[1]=TorpedosData.get(e)[7]+Math.sin(TorpedosData.get(e)[2]/180*Math.PI)*TorpedosData.get(e)[4]*(Date.now()-TorpedosData.get(e)[8])/1e3,(TorpedosData.get(e)[5]||TorpedosData.get(e)[0]>20||TorpedosData.get(e)[0]<-4||TorpedosData.get(e)[1]>19||TorpedosData.get(e)[1]<-4)&&TorpedosData.delete(e)}if(0!=Z)for(let e of VisibleObjs._){let t=MAPstatic._[e];ctx.beginPath(),ctx.moveTo(GameW/2+OffsetX-(X-t[0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.lineTo(GameW/2+OffsetX-(X-t[2]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[3]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.closePath(),ctx.strokeStyle=MAPstatic.CT.b2,ctx.lineCap="square",ctx.lineWidth=70/320*Zoom,ctx.stroke()}for(let e of VisibleObjs.B){let t=MAPstatic.B[e];ctx.fillStyle=MAPstatic.CT.bf,ctx.strokeStyle=MAPstatic.CT.bs,ctx.lineJoin="bevel",ctx.beginPath();for(let e=0;e<t.length;e+=1)0==e?ctx.moveTo(GameW/2+OffsetX-(X-t[0][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[0][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom):ctx.lineTo(GameW/2+OffsetX-(X-t[e][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[e][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom);ctx.closePath(),ctx.lineWidth=(5*(Math.sin(timenow/50/180*Math.PI)+1)+2)/320*Zoom,ctx.fill(),ctx.stroke()}for(let e of VisibleObjs.G){let t=MAPstatic.G[e];ctx.fillStyle=MAPstatic.CT.gf,ctx.strokeStyle=MAPstatic.CT.gs,ctx.lineWidth=10/320*Zoom,ctx.lineJoin="bevel",ctx.beginPath();for(let e=0;e<t.length;e+=1)0==e?ctx.moveTo(GameW/2+OffsetX-(X-t[0][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[0][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom):ctx.lineTo(GameW/2+OffsetX-(X-t[e][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[e][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom);ctx.closePath(),ctx.fill(),ctx.stroke()}if(0==Z)for(let e of VisibleObjs._){let t=MAPstatic._[e];ctx.beginPath(),ctx.moveTo(GameW/2+OffsetX-(X-t[0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.lineTo(GameW/2+OffsetX-(X-t[2]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[3]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.closePath(),ctx.strokeStyle=MAPstatic.CT.b2,ctx.lineCap="square",ctx.lineWidth=.1875*Zoom,ctx.stroke()}for(let e of VisibleObjs.C){let t=MAPstatic.C[e];ctx.fillStyle=MAPstatic.CT.cf,ctx.strokeStyle=MAPstatic.CT.cs,ctx.lineWidth=2.5/320*Zoom,ctx.lineJoin="bevel",ctx.beginPath();for(let e=0;e<t.length;e+=1)0==e?ctx.moveTo(GameW/2+OffsetX-(X-t[0][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[0][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom):ctx.lineTo(GameW/2+OffsetX-(X-t[e][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[e][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom);ctx.closePath(),ctx.fill(),ctx.stroke()}for(let e of VisibleObjs.R){let t=MAPstatic.R[e];ctx.strokeStyle=MAPstatic.CT.cs,ctx.lineWidth=.125*Zoom,ctx.beginPath(),ctx.lineJoin="round",ctx.lineCap="round";for(let e=0;e<t.length;e+=1)0==e?ctx.moveTo(GameW/2+OffsetX-(X-t[0][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[0][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom):ctx.lineTo(GameW/2+OffsetX-(X-t[e][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[e][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom);ctx.stroke(),ctx.closePath(),ctx.lineCap="square",ctx.lineJoin="bevel"}for(let e of VisibleObjs.R){let t=MAPstatic.R[e];ctx.lineWidth=2/320*Zoom,ctx.strokeStyle=MAPstatic.CT.rd,ctx.setLineDash([10/320*Zoom,10/320*Zoom]),ctx.beginPath();for(let e=0;e<t.length;e+=1)0==e?ctx.moveTo(GameW/2+OffsetX-(X-t[0][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[0][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom):ctx.lineTo(GameW/2+OffsetX-(X-t[e][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[e][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom);ctx.stroke(),ctx.setLineDash([]),ctx.closePath()}for(let e=0;e<MAPstatic["*"].length;e++)ctx.lineWidth=10/320*Zoom,"0"==Zones[e]?(ctx.strokeStyle="rgba(255,0,0,0.25)",ctx.fillStyle="rgba(255,0,0,0.25)"):(ctx.strokeStyle="rgba(0,0,255,0.25)",ctx.fillStyle="rgba(0,0,255,0.25)"),ctx.textAlign="center",ctx.font=(300*MAPstatic["*"][e][3]/320*Zoom).toString()+"px ZCOOL QingKe HuangYou",ctx.beginPath(),ctx.arc(GameW/2+OffsetX-(X-MAPstatic["*"][e][1]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-MAPstatic["*"][e][2]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom,MAPstatic["*"][e][3]*Zoom/2,0,2*Math.PI),ctx.fillText(MAPstatic["*"][e][0],GameW/2+OffsetX-(X-MAPstatic["*"][e][1]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-MAPstatic["*"][e][2]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom+100*MAPstatic["*"][e][3]/320*Zoom),ctx.closePath(),ctx.stroke();ctx.lineWidth=5,ctx.beginPath(),ctx.rect(GameW/2+OffsetX-(X+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom,WH*Zoom,WH*Zoom),ctx.closePath(),ctx.strokeStyle="#ff0000ff",ctx.stroke();for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("OnWater-2",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("OnWater-2",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("OnWater-1",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("OnWater-1",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("OnWater",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("OnWater",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("OnWater+1",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("OnWater+1",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("OnWater+2",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("OnWater+2",NoTeamTag(Players[e][0]));for(t=0;t<CanBangParticles0.length;t++)ctx.fillStyle="rgba(192,192,192,"+CanBangParticles0[t].life**1.5*1+")",ctx.beginPath(),ctx.arc(OffsetX+(CanBangParticles0[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2,OffsetY+GameH/2+(CanBangParticles0[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom,CanBangParticles0[t].rad/320*Zoom,0,2*Math.PI),ctx.closePath(),CanBangParticles0[t].x+=CanBangParticles0[t].xs/10*CanBangParticles0[t].life/320,CanBangParticles0[t].y+=CanBangParticles0[t].ys/10*CanBangParticles0[t].life/320,CanBangParticles0[t].rad+=.1*CanBangParticles0[t].life/320*Zoom,ctx.fill(),CanBangParticles0[t].life*=.99,CanBangParticles0[t].life<.001&&(CanBangParticles0.splice(t,1),t--);if(ParticlesProcessing)for(t=FireParticles0.length-1;t>=0;t--)ctx.fillStyle="rgba(255,"+255*FireParticles0[t].life/60+","+255*(FireParticles0[t].life/60)**3+","+.75*Math.sin(FireParticles0[t].life/60*Math.PI)+")",ctx.beginPath(),ctx.arc(OffsetX+(FireParticles0[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2-FireParticles0[t].cof*Math.cos(FireParticles0[t].dir)*FireParticles0[t].rad/320*Zoom,OffsetY+GameH/2+(FireParticles0[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom-FireParticles0[t].cof*Math.sin(FireParticles0[t].dir)*FireParticles0[t].rad/320*Zoom,FireParticles0[t].rad*Math.sin(FireParticles0[t].life/60*Math.PI)/320*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill(),FireParticles0[t].dirspd+=.03*(2*Math.random()-1),FireParticles0[t].dir+=FireParticles0[t].dirspd,FireParticles0[t].x+=Math.cos(FireParticles0[t].deg)*FireParticles0[t].speed*Math.sin(FireParticles0[t].life/60*Math.PI)*(1-FireParticles0[t].life/60)/320,FireParticles0[t].y+=Math.sin(FireParticles0[t].deg)*FireParticles0[t].speed*Math.sin(FireParticles0[t].life/60*Math.PI)*(1-FireParticles0[t].life/60)/320,FireParticles0[t].life*=.95,FireParticles0[t].life<5&&(FireParticles0.splice(t,1),t--);else FireParticles0=[];for(let e of VisibleObjs._){ctx.lineCap="butt";let t=MAPstatic._[e];len=.1/Math.sqrt((t[0]-t[2])*(t[0]-t[2])+(t[1]-t[3])*(t[1]-t[3])),ctx.beginPath(),ctx.lineCap="butt",ctx.moveTo(GameW/2+OffsetX-(X-t[0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.lineTo(GameW/2+OffsetX-(X-(t[0]+(t[2]-t[0])*len)+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-(t[1]+(t[3]-t[1])*len)+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.moveTo(GameW/2+OffsetX-(X-t[2]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[3]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.lineTo(GameW/2+OffsetX-(X-(t[0]+(t[2]-t[0])*(1-len))+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-(t[1]+(t[3]-t[1])*(1-len))+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.closePath(),ctx.strokeStyle=MAPstatic.CT.cs,ctx.lineWidth=.1875*Zoom,ctx.stroke()}if(Z>0)for(let e of VisibleObjs._){ctx.lineCap="square";let t=MAPstatic._[e];ctx.beginPath(),ctx.moveTo(GameW/2+OffsetX-(X-t[0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.lineTo(GameW/2+OffsetX-(X-t[2]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[3]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.closePath(),ctx.lineCap="square",ctx.strokeStyle=MAPstatic.CT.b1,ctx.lineWidth=.1875*Zoom,ctx.stroke(),ctx.strokeStyle=MAPstatic.CT.b0,ctx.lineWidth=50/320*Zoom,ctx.stroke()}for(let e of VisibleObjs["#"]){let t=MAPstatic["#"][e];for(let e=0;e<t.length;e+=1)if(2==t[e][6]){let a=[],o=Math.cos(t[e][5]/180*Math.PI),s=Math.sin(t[e][5]/180*Math.PI);a=[[-t[e][4]/2,-t[e][3]/2],[-t[e][4]/2,t[e][3]/2],[t[e][4]/2,t[e][3]/2],[t[e][4]/2,-t[e][3]/2]],ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.cs,ctx.lineWidth=2/320*Zoom,ctx.moveTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[0][1]*o*Zoom+a[0][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[0][1]*s*Zoom+a[0][0]*-o*Zoom);for(let n=1;n<a.length;n+=1)ctx.lineTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[n][1]*o*Zoom+a[n][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[n][1]*s*Zoom+a[n][0]*-o*Zoom);ctx.lineTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[0][1]*o*Zoom+a[0][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[0][1]*s*Zoom+a[0][0]*-o*Zoom),ctx.fill(),ctx.closePath()}}for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("OnGround-2",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("OnGround-2",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("OnGround-1",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("OnGround-1",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("OnGround",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("OnGround",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("OnGround+1",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("OnGround+1",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("OnGround+2",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("OnGround+2",NoTeamTag(Players[e][0]));for(let e of BulletsData.keys())0==BulletsData.get(e)[4]&&(1==BulletsData.get(e)[3]||3==BulletsData.get(e)[3]?(Math.random()<1&&PIXI.sound.play("dmg"+Math.floor(4*Math.random())),3==BulletsData.get(e)[3]&&(ShakeXbnds+=5,ShakeYbnds+=5),BulletsData.get(e)[3]=0):2==BulletsData.get(e)[3]&&(Math.random()<1&&PIXI.sound.play("Sdmg"+Math.floor(2*Math.random())),BulletsData.get(e)[3]=0),grad=ctx.createLinearGradient(GameW/2+OffsetX-(X-BulletsData.get(e)[0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-BulletsData.get(e)[1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom,GameW/2+OffsetX-(X-BulletsData.get(e)[0]+Math.cos(BulletsData.get(e)[2]/180*Math.PI)*BulletsData.get(e)[11]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-BulletsData.get(e)[1]+Math.sin(BulletsData.get(e)[2]/180*Math.PI)*BulletsData.get(e)[11]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),Z<2?(grad.addColorStop(1,"#FFFF4400"),grad.addColorStop(0,"#FFFF4488")):(grad.addColorStop(1,"#ffff8800"),grad.addColorStop(0,"#ffff8877")),ctx.strokeStyle=grad,ctx.lineWidth=BulletsData.get(e)[6]/320*Zoom,ctx.beginPath(),ctx.lineCap="round",ctx.moveTo(GameW/2+OffsetX-(X-BulletsData.get(e)[0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-BulletsData.get(e)[1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.lineTo(GameW/2+OffsetX-(X-BulletsData.get(e)[0]+Math.cos(BulletsData.get(e)[2]/180*Math.PI)*BulletsData.get(e)[11]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-BulletsData.get(e)[1]+Math.sin(BulletsData.get(e)[2]/180*Math.PI)*BulletsData.get(e)[11]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.stroke(),ctx.closePath(),BulletsData.get(e)[0]=BulletsData.get(e)[8]+Math.cos(BulletsData.get(e)[2]/180*Math.PI)*BulletsData.get(e)[5]*((Date.now()-BulletsData.get(e)[10])/1e3),BulletsData.get(e)[1]=BulletsData.get(e)[9]+Math.sin(BulletsData.get(e)[2]/180*Math.PI)*BulletsData.get(e)[5]*((Date.now()-BulletsData.get(e)[10])/1e3),(Date.now()-BulletsData.get(e)[10])/1e3-1/15>0?(BulletsData.get(e)[11]=BulletsData.get(e)[5]*((Date.now()-BulletsData.get(e)[10])/1e3-2/15),BulletsData.get(e)[11]>.3&&(BulletsData.get(e)[11]=.3)):BulletsData.get(e)[11]=0,(BulletsData.get(e)[7]||BulletsData.get(e)[0]>20||BulletsData.get(e)[0]<-4||BulletsData.get(e)[1]>19||BulletsData.get(e)[1]<-4)&&BulletsData.delete(e));for(let e of SmokesData.keys())try{ctx.fillStyle="rgba(255,255,255,0.25)";let a=0;ctx.beginPath();let o=(Date.now()-SmokesData.get(e)[2])/100,s=.02*(Math.sqrt(o)-(Math.sqrt(o)-17.3)*Math.sqrt(o)*.3);for(ctx.arc(OffsetX+(SmokesData.get(e)[0]-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2,OffsetY+GameH/2+(SmokesData.get(e)[1]-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom,s*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill(),t=0;t<SmokesData.get(e)[4].length;t++)SmokesData.get(e)[4][t].hp-=1,SmokesData.get(e)[4][t].dir+=.025*SmokesData.get(e)[4][t].spd,SmokesData.get(e)[4][t].hp<0&&(SmokesData.get(e)[4].splice(t,1),t--);for(t=0;t<SmokesData.get(e)[4].length;t++)ctx.fillStyle="rgba("+SmokesData.get(e)[4][t].cl+","+SmokesData.get(e)[4][t].cl+","+SmokesData.get(e)[4][t].cl+","+SmokesData.get(e)[4][t].hp/1500+")",ctx.beginPath(),a+=1,ctx.arc(Math.cos(SmokesData.get(e)[4][t].dir)*SmokesData.get(e)[4][t].h*s*.5*Zoom+(SmokesData.get(e)[0]-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2,Math.sin(SmokesData.get(e)[4][t].dir)*Zoom*SmokesData.get(e)[4][t].h*s*.5+OffsetY+OffsetY+GameH/2+(SmokesData.get(e)[1]-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom,s*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill();Math.random()<.1&&a<10&&SmokesData.get(e)[4].push(new Particle3(e)),SmokesData.get(e)[3]&&SmokesData.delete(e)}catch{SmokesData.delete(e)}for(let e of VisibleObjs.S){let t=MAPstatic.S[e];ctx.fillStyle=MAPstatic.CT.sf,ctx.lineWidth=5/320*Zoom,ctx.lineJoin="round",ctx.strokeStyle=MAPstatic.CT.ss,ctx.beginPath();for(let e=0;e<t.length;e+=1)0==e?ctx.moveTo(GameW/2+OffsetX-(X-t[0][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[0][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom):ctx.lineTo(GameW/2+OffsetX-(X-t[e][0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-t[e][1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom);ctx.closePath(),ctx.fill(),ctx.stroke(),ctx.lineJoin="miter"}for(t=0;t<WtrBangParticles0.length;t++)ctx.fillStyle="rgba(255,255,255,"+WtrBangParticles0[t].life**.33*1+")",ctx.beginPath(),ctx.arc(OffsetX+(WtrBangParticles0[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2,OffsetY+GameH/2+(WtrBangParticles0[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom,WtrBangParticles0[t].rad/320*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill(),ctx.fillStyle="rgba(0,160,255,"+WtrBangParticles0[t].life**1*1+")",ctx.beginPath(),ctx.arc(OffsetX+(WtrBangParticles0[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2+Math.cos(WtrBangParticles0[t].dir+WtrBangParticles0[t].life*Math.PI*2)*WtrBangParticles0[t].rad*.2,OffsetY+GameH/2+(WtrBangParticles0[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom+Math.sin(WtrBangParticles0[t].dir+WtrBangParticles0[t].life*Math.PI*2)*WtrBangParticles0[t].rad*.2,.8*WtrBangParticles0[t].rad/320*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill(),WtrBangParticles0[t].dir+=.25*WtrBangParticles0[t].life,WtrBangParticles0[t].x+=WtrBangParticles0[t].xs/Zoom/4*WtrBangParticles0[t].life/320*Zoom,WtrBangParticles0[t].y+=WtrBangParticles0[t].ys/Zoom/4*WtrBangParticles0[t].life/320*Zoom,WtrBangParticles0[t].rad+=.75*WtrBangParticles0[t].life**1.25,WtrBangParticles0[t].life*=.98,WtrBangParticles0[t].life<1e-4&&(WtrBangParticles0.splice(t,1),t--);for(t=0;t<BangParticles0.length;t++)ctx.fillStyle="rgba(0,0,0,"+BangParticles0[t].life**.33*1+")",ctx.beginPath(),ctx.arc(OffsetX+(BangParticles0[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2,OffsetY+GameH/2+(BangParticles0[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom,BangParticles0[t].rad/320*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill(),ctx.fillStyle="rgba(255,160,0,"+BangParticles0[t].life**1*1+")",ctx.beginPath(),ctx.arc(OffsetX+(BangParticles0[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2+Math.cos(BangParticles0[t].dir+BangParticles0[t].life*Math.PI*2)*BangParticles0[t].rad*.2/320*Zoom,OffsetY+GameH/2+(BangParticles0[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom+Math.sin(BangParticles0[t].dir+BangParticles0[t].life*Math.PI*2)*BangParticles0[t].rad*.2/320*Zoom,BangParticles0[t].rad/320*Zoom*.8,0,2*Math.PI),ctx.closePath(),ctx.fill(),BangParticles0[t].dir+=.25*BangParticles0[t].life,BangParticles0[t].x+=BangParticles0[t].xs/4*BangParticles0[t].life/320,BangParticles0[t].y+=BangParticles0[t].ys/4*BangParticles0[t].life/320,BangParticles0[t].rad+=.75*BangParticles0[t].life**1.25,BangParticles0[t].life*=.98,BangParticles0[t].life<1e-4&&(BangParticles0.splice(t,1),t--);for(t=0;t<CanBangParticles1.length;t++)ctx.fillStyle="rgba(192,192,192,"+CanBangParticles1[t].life**1.5*1+")",ctx.beginPath(),ctx.arc(OffsetX+(CanBangParticles1[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2,OffsetY+GameH/2+(CanBangParticles1[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom,CanBangParticles1[t].rad/320*Zoom,0,2*Math.PI),ctx.closePath(),CanBangParticles1[t].x+=CanBangParticles1[t].xs/10*CanBangParticles1[t].life/320,CanBangParticles1[t].y+=CanBangParticles1[t].ys/10*CanBangParticles1[t].life/320,CanBangParticles1[t].rad+=.1*CanBangParticles1[t].life/320*Zoom,ctx.fill(),CanBangParticles1[t].life*=.99,CanBangParticles1[t].life<.001&&(CanBangParticles1.splice(t,1),t--);for(let e of VisibleObjs["#"]){let t=MAPstatic["#"][e];for(let e=0;e<t.length;e+=1)if(t[e][6]%2==1&&(3==t[e][6]&&(ShakeXbnds+=10,ShakeYbnds+=1),t[e][6]-=1),2!=t[e][6])if(0==t[e][0]){let a=[],o=Math.cos(t[e][5]/180*Math.PI),s=Math.sin(t[e][5]/180*Math.PI);a=t[e][3]>t[e][4]?[[0,-t[e][3]/2],[0,t[e][3]/2],[t[e][4]/2,t[e][3]/2],[t[e][4]/2,-t[e][3]/2]]:[[-t[e][4]/2,0],[t[e][4]/2,0],[t[e][4]/2,t[e][3]/2],[-t[e][4]/2,t[e][3]/2]],ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.rr,ctx.moveTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[0][1]*o*Zoom+a[0][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[0][1]*s*Zoom+a[0][0]*-o*Zoom);for(let n=1;n<a.length;n+=1)ctx.lineTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[n][1]*o*Zoom+a[n][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[n][1]*s*Zoom+a[n][0]*-o*Zoom);ctx.lineTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[0][1]*o*Zoom+a[0][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[0][1]*s*Zoom+a[0][0]*-o*Zoom),ctx.fill(),ctx.closePath(),a=t[e][3]>t[e][4]?[[-t[e][4]/2,-t[e][3]/2],[-t[e][4]/2,t[e][3]/2],[0,t[e][3]/2],[0,-t[e][3]/2]]:[[-t[e][4]/2,-t[e][3]/2],[t[e][4]/2,-t[e][3]/2],[t[e][4]/2,0],[-t[e][4]/2,0]],ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.rl,ctx.moveTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[0][1]*o*Zoom+a[0][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[0][1]*s*Zoom+a[0][0]*-o*Zoom);for(let n=1;n<a.length;n+=1)ctx.lineTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[n][1]*o*Zoom+a[n][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[n][1]*s*Zoom+a[n][0]*-o*Zoom);ctx.lineTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[0][1]*o*Zoom+a[0][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[0][1]*s*Zoom+a[0][0]*-o*Zoom),ctx.fill(),ctx.closePath()}else if(1==t[e][0]){let a=[],o=Math.cos(t[e][5]/180*Math.PI),s=Math.sin(t[e][5]/180*Math.PI);a=[[-t[e][3],0],[t[e][3],0]],ctx.beginPath(),ctx.moveTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[0][1]*o*Zoom+a[0][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[0][1]*s*Zoom+a[0][0]*-o*Zoom);for(let n=1;n<a.length;n+=1)ctx.lineTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[n][1]*o*Zoom+a[n][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[n][1]*s*Zoom+a[n][0]*-o*Zoom);ctx.lineCap="butt",ctx.lineWidth=t[e][4]*Zoom/2,ctx.strokeStyle=MAPstatic.CT["w"+e%3],ctx.stroke(),ctx.strokeStyle=MAPstatic.CT["e"+e%3],ctx.setLineDash([2/320*Zoom,2/320*Zoom]),ctx.stroke(),ctx.setLineDash([]),ctx.closePath()}else if(2==t[e][0]){let a=[],o=Math.cos(t[e][5]/180*Math.PI),s=Math.sin(t[e][5]/180*Math.PI);a=[[-t[e][3]/2,-t[e][3]/2],[-t[e][3]/2,t[e][3]/2],[t[e][3]/2,t[e][3]/2],[t[e][3]/2,-t[e][3]/2]],ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.if,ctx.moveTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[0][1]*o*Zoom+a[0][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[0][1]*s*Zoom+a[0][0]*-o*Zoom);for(let n=1;n<a.length;n+=1)ctx.lineTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[n][1]*o*Zoom+a[n][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[n][1]*s*Zoom+a[n][0]*-o*Zoom);ctx.lineTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[0][1]*o*Zoom+a[0][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[0][1]*s*Zoom+a[0][0]*-o*Zoom),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.is,ctx.arc(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY,t[e][3]/2*Zoom,0,2*Math.PI),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.io,ctx.arc(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY,t[e][3]*Zoom/3,0,2*Math.PI),ctx.fill(),ctx.closePath()}else if(3==t[e][0]){let a=[],o=Math.cos(t[e][5]/180*Math.PI),s=Math.sin(t[e][5]/180*Math.PI);a=[[-t[e][4]/2,-t[e][3]/2],[-t[e][4]/2,t[e][3]/2],[t[e][4]/2,t[e][3]/2],[t[e][4]/2,-t[e][3]/2]],ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.hf,ctx.strokeStyle=MAPstatic.CT.hs,ctx.lineWidth=2/320*Zoom,ctx.moveTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[0][1]*o*Zoom+a[0][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[0][1]*s*Zoom+a[0][0]*-o*Zoom);for(let n=1;n<a.length;n+=1)ctx.lineTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[n][1]*o*Zoom+a[n][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[n][1]*s*Zoom+a[n][0]*-o*Zoom);ctx.lineTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[0][1]*o*Zoom+a[0][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[0][1]*s*Zoom+a[0][0]*-o*Zoom),ctx.fill(),ctx.stroke(),ctx.closePath(),o=Math.cos(t[e][5]/180*Math.PI),s=Math.sin(t[e][5]/180*Math.PI),a=t[e][3]>t[e][4]?[[0,-t[e][3]/2],[0,t[e][3]/2]]:[[-t[e][4]/2,0],[t[e][4]/2,0]],ctx.beginPath(),ctx.moveTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[0][1]*o*Zoom+a[0][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[0][1]*s*Zoom+a[0][0]*-o*Zoom);for(let n=1;n<a.length;n+=1)ctx.lineTo(((-nX+X)*(Date.now()-LastPING)/PING-X+t[e][1])*Zoom+GameW/2+OffsetX+a[n][1]*o*Zoom+a[n][0]*Zoom*s,((-nY+Y)*(Date.now()-LastPING)/PING-Y+t[e][2])*Zoom+GameH/2+OffsetY+a[n][1]*s*Zoom+a[n][0]*-o*Zoom);ctx.lineCap="butt",t[e][3]>t[e][4]?ctx.lineWidth=t[e][4]*Zoom:ctx.lineWidth=t[e][3]*Zoom,ctx.strokeStyle=MAPstatic.CT.hs,ctx.setLineDash([2/320*Zoom,6/320*Zoom]),ctx.stroke(),ctx.setLineDash([]),ctx.closePath()}}if(ParticlesProcessing)for(t=FireParticles1.length-1;t>=0;t--)ctx.fillStyle="rgba(255,"+255*FireParticles1[t].life/60+","+255*(FireParticles1[t].life/60)**3+","+.75*Math.sin(FireParticles1[t].life/60*Math.PI)+")",ctx.beginPath(),ctx.arc(OffsetX+(FireParticles1[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2-FireParticles1[t].cof*Math.cos(FireParticles1[t].dir)*FireParticles1[t].rad/320*Zoom,OffsetY+GameH/2+(FireParticles1[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom-FireParticles1[t].cof*Math.sin(FireParticles1[t].dir)*FireParticles1[t].rad/320*Zoom,FireParticles1[t].rad*Math.sin(FireParticles1[t].life/60*Math.PI)/320*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill(),FireParticles1[t].dirspd+=.03*(2*Math.random()-1),FireParticles1[t].dir+=FireParticles1[t].dirspd,FireParticles1[t].x+=Math.cos(FireParticles1[t].deg)*FireParticles1[t].speed*Math.sin(FireParticles1[t].life/60*Math.PI)*(1-FireParticles1[t].life/60)/320,FireParticles1[t].y+=Math.sin(FireParticles1[t].deg)*FireParticles1[t].speed*Math.sin(FireParticles1[t].life/60*Math.PI)*(1-FireParticles1[t].life/60)/320,FireParticles1[t].life*=.95,FireParticles1[t].life<5&&(FireParticles1.splice(t,1),t--);else FireParticles1=[];for(t=0;t<BangParticles1.length;t++)ctx.fillStyle="rgba(0,0,0,"+BangParticles1[t].life**.33*1+")",ctx.beginPath(),ctx.arc(OffsetX+(BangParticles1[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2,OffsetY+GameH/2+(BangParticles1[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom,BangParticles1[t].rad/320*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill(),ctx.fillStyle="rgba(255,160,0,"+BangParticles1[t].life**1*1+")",ctx.beginPath(),ctx.arc(OffsetX+(BangParticles1[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2+Math.cos(BangParticles1[t].dir+BangParticles1[t].life*Math.PI*2)*BangParticles1[t].rad*.2/320*Zoom,OffsetY+GameH/2+(BangParticles1[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom+Math.sin(BangParticles1[t].dir+BangParticles1[t].life*Math.PI*2)*BangParticles1[t].rad*.2/320*Zoom,.8*BangParticles1[t].rad/320*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill(),BangParticles1[t].dir+=.25*BangParticles1[t].life,BangParticles1[t].x+=BangParticles1[t].xs/4*BangParticles1[t].life/320,BangParticles1[t].y+=BangParticles1[t].ys/4*BangParticles1[t].life/320,BangParticles1[t].rad+=.75*BangParticles1[t].life**1.25,BangParticles1[t].life*=.98,BangParticles1[t].life<1e-4&&(BangParticles1.splice(t,1),t--);let e="ff";1==Z&&(e="88");for(let t of VisibleObjs.T){let a=MAPstatic.T[t];for(let t=0;t<a.length;t+=1)0==a[t][0]?(ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.tf+e,ctx.arc(GameW/2+OffsetX-(X-a[t][1]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-a[t][2]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom,Zoom*tree_size.get(a[t][3])/2,0,2*Math.PI),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.tm+e,ctx.arc(GameW/2+OffsetX-(X-a[t][1]+(nX-X)*(Date.now()-LastPING)/PING-tree_size.get(a[t][3])*Math.cos(24*t)/5)*Zoom,GameH/2+OffsetY-(Y-a[t][2]+(nY-Y)*(Date.now()-LastPING)/PING-tree_size.get(a[t][3])*Math.sin(15*t)/5)*Zoom,Zoom*tree_size.get(a[t][3])/2*2/3,0,2*Math.PI),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.tt+e,ctx.arc(GameW/2+OffsetX-(X-a[t][1]+(nX-X)*(Date.now()-LastPING)/PING-tree_size.get(a[t][3])*Math.cos(648*t)/5)*Zoom,GameH/2+OffsetY-(Y-a[t][2]+(nY-Y)*(Date.now()-LastPING)/PING-tree_size.get(a[t][3])*Math.sin(541*t)/5)*Zoom,Zoom*tree_size.get(a[t][3])/2*2/3,0,2*Math.PI),ctx.fill(),ctx.beginPath()):1==a[t][0]?(ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.ff+e,ctx.arc(GameW/2+OffsetX-(X-a[t][1]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-a[t][2]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom,Zoom*tree_size.get(a[t][3])/2,0,2*Math.PI),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.fm+e,ctx.arc(GameW/2+OffsetX-(X-a[t][1]+(nX-X)*(Date.now()-LastPING)/PING-tree_size.get(a[t][3])*Math.cos(648*t)/24)*Zoom,GameH/2+OffsetY-(Y-a[t][2]+(nY-Y)*(Date.now()-LastPING)/PING-tree_size.get(a[t][3])*Math.sin(463*t)/24)*Zoom,Zoom*tree_size.get(a[t][3])/2*2/3,0,2*Math.PI),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.ft+e,ctx.arc(GameW/2+OffsetX-(X-a[t][1]+(nX-X)*(Date.now()-LastPING)/PING-tree_size.get(a[t][3])*Math.cos(765*t)/24)*Zoom,GameH/2+OffsetY-(Y-a[t][2]+(nY-Y)*(Date.now()-LastPING)/PING-tree_size.get(a[t][3])*Math.sin(245*t)/24)*Zoom,Zoom*tree_size.get(a[t][3])/2*1/3,0,2*Math.PI),ctx.fill(),ctx.beginPath()):2==a[t][0]&&(ctx.lineWidth=Zoom*tree_size.get(a[t][3])/12,ctx.beginPath(),ctx.fillStyle=MAPstatic.CT.pf+e,ctx.arc(GameW/2+OffsetX-(X-a[t][1]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-a[t][2]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom,Zoom*tree_size.get(a[t][3])/2,0,2*Math.PI),ctx.fill(),ctx.closePath(),ctx.beginPath(),ctx.strokeStyle=MAPstatic.CT.pm+e,ctx.arc(GameW/2+OffsetX-(X-a[t][1]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-a[t][2]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom,Zoom*tree_size.get(a[t][3])/3,0,2*Math.PI),ctx.stroke(),ctx.closePath(),ctx.beginPath(),ctx.strokeStyle=MAPstatic.CT.pt+e,ctx.arc(GameW/2+OffsetX-(X-a[t][1]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-a[t][2]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom,Zoom*tree_size.get(a[t][3])/2/3,0,2*Math.PI),ctx.stroke(),ctx.closePath())}for(let e of BombsData.keys()){let t=(Date.now()-BombsData.get(e)[6])/1e3/BombsData.get(e)[5],a=0;BombsData.get(e)[4]<5||(t=Math.sin((t-.5)*Math.PI)/2+.5,a=Math.sqrt((BombsData.get(e)[2]-BombsData.get(e)[0])**2+(BombsData.get(e)[3]-BombsData.get(e)[1])**2));let o=BombsData.get(e)[0]+(BombsData.get(e)[2]-BombsData.get(e)[0])*t,s=BombsData.get(e)[1]+(BombsData.get(e)[3]-BombsData.get(e)[1])*t;if(1==BombsData.get(e)[4]){BombsData.get(e)[4]=0,PIXI.sound.play("bang");for(let t=0;t<5;t++)BangParticles1.push(new bangPrt(BombsData.get(e)[2],BombsData.get(e)[3]));ShakeXbnds+=10,ShakeYbnds+=10}else if(2==BombsData.get(e)[4])PIXI.sound.play("bombFall"),BombsData.get(e)[4]=0;else if(6==BombsData.get(e)[4])BombsData.get(e)[4]=5;else if(4==BombsData.get(e)[4]){PIXI.sound.play("wtrBang");for(let t=0;t<5;t++)WtrBangParticles0.push(new BangPrt0(BombsData.get(e)[2],BombsData.get(e)[3]));ShakeXbnds+=5,ShakeYbnds+=5}if(BombsData.get(e)[4]<5){ctx.strokeStyle="#111",ctx.lineWidth=3/320*Zoom,ctx.beginPath(),ctx.lineCap="round";let t=.015;ctx.moveTo(GameW/2+OffsetX-(X-o+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-s+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.lineTo(GameW/2+OffsetX-(X-o+Math.cos(BombsData.get(e)[8]/180*Math.PI)*t+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-s+Math.sin(BombsData.get(e)[8]/180*Math.PI)*t+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.stroke(),ctx.closePath()}else if(t*a>.05){let n=a/3*(1-2*Math.abs(t-.5))+.025;grad=ctx.createLinearGradient(GameW/2+OffsetX-(X-o+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-s+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom,GameW/2+OffsetX-(X-o+Math.cos(BombsData.get(e)[8]/180*Math.PI)*n+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-s+Math.sin(BombsData.get(e)[8]/180*Math.PI)*n+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),grad.addColorStop(1,"rgba(255,255,64,0)"),grad.addColorStop(0,"rgba(255,255,64,"+(2*Math.abs(t-.5)*.4+.1).toString()+")"),ctx.strokeStyle=grad,ctx.lineWidth=(10-10*Math.abs(t-.5))/320*Zoom,ctx.beginPath(),ctx.lineCap="round",ctx.moveTo(GameW/2+OffsetX-(X-o+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-s+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.lineTo(GameW/2+OffsetX-(X-o+Math.cos(BombsData.get(e)[8]/180*Math.PI)*n+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-s+Math.sin(BombsData.get(e)[8]/180*Math.PI)*n+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.stroke(),ctx.closePath()}(BombsData.get(e)[7]||o>16||o<0||s>16||s<0)&&BombsData.delete(e)}for(let e of AARocketsData.keys()){if(1==AARocketsData.get(e)[3]){AARocketsData.get(e)[3]=0,PIXI.sound.play("rocketHit");for(let t=0;t<15;t++)FireParticles1.push(new FirePrt0(AARocketsData.get(e)[0],AARocketsData.get(e)[1],.75));ShakeXbnds+=10,ShakeYbnds+=10}else if(2==AARocketsData.get(e)[3])PIXI.sound.play("lnchRckt"),AARocketsData.get(e)[3]=0;else if(4==AARocketsData.get(e)[3])for(let t=0;t<3;t++)FireParticles1.push(new FirePrt0(AARocketsData.get(e)[0],AARocketsData.get(e)[1],.5));grad=ctx.createLinearGradient(GameW/2+OffsetX-(X-AARocketsData.get(e)[0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-AARocketsData.get(e)[1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom,GameW/2+OffsetX-(X-AARocketsData.get(e)[0]+Math.cos(AARocketsData.get(e)[2]/180*Math.PI)*AARocketsData.get(e)[4]/10+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-AARocketsData.get(e)[1]+Math.sin(AARocketsData.get(e)[2]/180*Math.PI)*AARocketsData.get(e)[4]/10+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),Math.random()<1&&RocketTraceParticles.push(new RcktTPrt0(AARocketsData.get(e)[0]-Math.cos(AARocketsData.get(e)[2]/180*Math.PI)*AARocketsData.get(e)[4]/20,AARocketsData.get(e)[1]-Math.sin(AARocketsData.get(e)[2]/180*Math.PI)*AARocketsData.get(e)[4]/20)),grad.addColorStop(1,"#FF880088"),grad.addColorStop(0,"#cc0000ff"),ctx.strokeStyle=grad,ctx.lineWidth=2/320*Zoom,ctx.beginPath(),ctx.lineCap="round",ctx.moveTo(GameW/2+OffsetX-(X-AARocketsData.get(e)[0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-AARocketsData.get(e)[1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.lineTo(GameW/2+OffsetX-(X-AARocketsData.get(e)[0]+Math.cos(AARocketsData.get(e)[2]/180*Math.PI)*AARocketsData.get(e)[4]/10+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-AARocketsData.get(e)[1]+Math.sin(AARocketsData.get(e)[2]/180*Math.PI)*AARocketsData.get(e)[4]/10+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.stroke(),ctx.closePath();let t=(Date.now()-AARocketsData.get(e)[8])/1e3;distanceFromStart=AARocketsData.get(e)[4]*t+AARocketsData.get(e)[9]*t*t/2,AARocketsData.get(e)[0]=AARocketsData.get(e)[6]+Math.cos(AARocketsData.get(e)[2]/180*Math.PI)*distanceFromStart,AARocketsData.get(e)[1]=AARocketsData.get(e)[7]+Math.sin(AARocketsData.get(e)[2]/180*Math.PI)*distanceFromStart,(AARocketsData.get(e)[5]||AARocketsData.get(e)[0]>20||AARocketsData.get(e)[0]<-4||AARocketsData.get(e)[1]>19||AARocketsData.get(e)[1]<-4)&&AARocketsData.delete(e)}if(ParticlesProcessing)for(t=RocketTraceParticles.length-1;t>=0;t--)ctx.fillStyle="rgba("+(150+105*RocketTraceParticles[t].life).toString()+","+(150+105*RocketTraceParticles[t].life).toString()+","+(150-150*RocketTraceParticles[t].life)+","+255*RocketTraceParticles[t].life+")",ctx.beginPath(),ctx.arc(OffsetX+(RocketTraceParticles[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2,OffsetY+GameH/2+(RocketTraceParticles[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom,RocketTraceParticles[t].rad*RocketTraceParticles[t].life**.3*2/320*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill(),RocketTraceParticles[t].life*=.7,RocketTraceParticles[t].life<.05&&(RocketTraceParticles.splice(t,1),t--);else RocketTraceParticles=[];for(ctx.globalCompositeOperation="color",t=0;t<TracerParticles1.length;t++)ctx.strokeStyle="rgba(200,0,0,"+TracerParticles1[t].life**.2*4+")",ctx.lineWidth=3/320*Zoom,ctx.lineJoin="round",ctx.beginPath(),ctx.moveTo(OffsetX+(TracerParticles1[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2,OffsetY+GameH/2+(TracerParticles1[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom),ctx.lineTo(OffsetX+(TracerParticles1[t].x1-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2,OffsetY+GameH/2+(TracerParticles1[t].y1-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom),ctx.closePath(),ctx.stroke(),TracerParticles1[t].life*=.93,TracerParticles1[t].life<1e-8&&(TracerParticles1.splice(t,1),t--);ctx.globalCompositeOperation="source-over";for(let e of BulletsData.keys())1==BulletsData.get(e)[4]&&(1==BulletsData.get(e)[3]||3==BulletsData.get(e)[3]?(Math.random()<1&&PIXI.sound.play("dmg"+Math.floor(4*Math.random())),3==BulletsData.get(e)[3]&&(ShakeXbnds+=5,ShakeYbnds+=5),BulletsData.get(e)[3]=0):2==BulletsData.get(e)[3]&&(Math.random()<1&&PIXI.sound.play("Sdmg"+Math.floor(2*Math.random())),BulletsData.get(e)[3]=0),grad=ctx.createLinearGradient(GameW/2+OffsetX-(X-BulletsData.get(e)[0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-BulletsData.get(e)[1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom,GameW/2+OffsetX-(X-BulletsData.get(e)[0]+Math.cos(BulletsData.get(e)[2]/180*Math.PI)*BulletsData.get(e)[11]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-BulletsData.get(e)[1]+Math.sin(BulletsData.get(e)[2]/180*Math.PI)*BulletsData.get(e)[11]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),2==Z?(grad.addColorStop(1,"#FFFF4400"),grad.addColorStop(0,"#FFFF4488")):(grad.addColorStop(1,"#ffffaa00"),grad.addColorStop(0,"#ffffaa88")),ctx.strokeStyle=grad,ctx.lineWidth=BulletsData.get(e)[6]/320*Zoom,ctx.beginPath(),ctx.lineCap="round",ctx.moveTo(GameW/2+OffsetX-(X-BulletsData.get(e)[0]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-BulletsData.get(e)[1]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.lineTo(GameW/2+OffsetX-(X-BulletsData.get(e)[0]+Math.cos(BulletsData.get(e)[2]/180*Math.PI)*BulletsData.get(e)[11]+(nX-X)*(Date.now()-LastPING)/PING)*Zoom,GameH/2+OffsetY-(Y-BulletsData.get(e)[1]+Math.sin(BulletsData.get(e)[2]/180*Math.PI)*BulletsData.get(e)[11]+(nY-Y)*(Date.now()-LastPING)/PING)*Zoom),ctx.stroke(),ctx.closePath(),BulletsData.get(e)[0]=BulletsData.get(e)[8]+Math.cos(BulletsData.get(e)[2]/180*Math.PI)*BulletsData.get(e)[5]*((Date.now()-BulletsData.get(e)[10])/1e3),BulletsData.get(e)[1]=BulletsData.get(e)[9]+Math.sin(BulletsData.get(e)[2]/180*Math.PI)*BulletsData.get(e)[5]*((Date.now()-BulletsData.get(e)[10])/1e3),(Date.now()-BulletsData.get(e)[10])/1e3-1/15>0?(BulletsData.get(e)[11]=BulletsData.get(e)[5]*((Date.now()-BulletsData.get(e)[10])/1e3-2/15),BulletsData.get(e)[11]>.3&&(BulletsData.get(e)[11]=.3)):BulletsData.get(e)[11]=0,(BulletsData.get(e)[7]||BulletsData.get(e)[0]>20||BulletsData.get(e)[0]<-4||BulletsData.get(e)[1]>19||BulletsData.get(e)[1]<-4)&&BulletsData.delete(e));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("Air-2",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("Air-2",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("Air-1",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("Air-1",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("Air",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("Air",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("Air+1",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("Air+1",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("Air+2",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("Air+2",NoTeamTag(Players[e][0]));if(ParticlesProcessing)for(t=FireParticles2.length-1;t>=0;t--)ctx.fillStyle="rgba(255,"+255*FireParticles2[t].life/60+","+255*(FireParticles2[t].life/60)**3+","+.75*Math.sin(FireParticles2[t].life/60*Math.PI)+")",ctx.beginPath(),ctx.arc(OffsetX+(FireParticles2[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2-FireParticles2[t].cof*Math.cos(FireParticles2[t].dir)*FireParticles2[t].rad/320*Zoom,OffsetY+GameH/2+(FireParticles2[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom-FireParticles2[t].cof*Math.sin(FireParticles2[t].dir)*FireParticles2[t].rad/320*Zoom,FireParticles2[t].rad*Math.sin(FireParticles2[t].life/60*Math.PI)/320*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill(),FireParticles2[t].dirspd+=.03*(2*Math.random()-1),FireParticles2[t].dir+=FireParticles2[t].dirspd,FireParticles2[t].x+=Math.cos(FireParticles2[t].deg)*FireParticles2[t].speed*Math.sin(FireParticles2[t].life/60*Math.PI)*(1-FireParticles2[t].life/60)/320,FireParticles2[t].y+=Math.sin(FireParticles2[t].deg)*FireParticles2[t].speed*Math.sin(FireParticles2[t].life/60*Math.PI)*(1-FireParticles2[t].life/60)/320,FireParticles2[t].life*=.95,FireParticles2[t].life<5&&(FireParticles2.splice(t,1),t--);else FireParticles1=[];for(t=0;t<BangParticles2.length;t++)ctx.fillStyle="rgba(0,0,0,"+BangParticles2[t].life**.33*1+")",ctx.beginPath(),ctx.arc(OffsetX+(BangParticles2[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2,OffsetY+GameH/2+(BangParticles2[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom,BangParticles2[t].rad/320*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill(),ctx.fillStyle="rgba(255,160,0,"+BangParticles2[t].life**1*1+")",ctx.beginPath(),ctx.arc(OffsetX+(BangParticles2[t].x-(X+(nX-X)*((Date.now()-LastPING)/PING)))*Zoom+GameW/2+Math.cos(BangParticles2[t].dir+BangParticles2[t].life*Math.PI*2)*BangParticles2[t].rad*.2/320*Zoom,OffsetY+GameH/2+(BangParticles2[t].y-(Y+(nY-Y)*((Date.now()-LastPING)/PING)))*Zoom+Math.sin(BangParticles2[t].dir+BangParticles2[t].life*Math.PI*2)*BangParticles2[t].rad*.2/320*Zoom,.8*BangParticles2[t].rad/320*Zoom,0,2*Math.PI),ctx.closePath(),ctx.fill(),BangParticles2[t].dir+=.25*BangParticles2[t].life,BangParticles2[t].x+=BangParticles2[t].xs/Zoom/4*BangParticles2[t].life,BangParticles2[t].y+=BangParticles2[t].ys/Zoom/4*BangParticles2[t].life,BangParticles2[t].rad+=.75*BangParticles2[t].life**1.25,BangParticles2[t].life*=.98,BangParticles2[t].life<1e-4&&(BangParticles2.splice(t,1),t--);for(t=0;t<SnowParticles0.length;t++)Math.abs(nX-X)>1||Math.abs(nY-Y)>1||(SnowParticles0[t].ra+=SnowParticles0[t].as,SnowParticles0[t].x-=SnowParticles0[t].d*Math.sqrt(SnowParticles0[t].r/2)*Math.cos(SnowParticles0[t].ra),SnowParticles0[t].y-=SnowParticles0[t].d*Math.sqrt(SnowParticles0[t].r/2)*Math.sin(SnowParticles0[t].ra),SnowParticles0[t].x-=SnowParticles0[t].d*Math.sqrt(SnowParticles0[t].r/2)*(nX-X)*Zoom,SnowParticles0[t].y-=SnowParticles0[t].d*Math.sqrt(SnowParticles0[t].r/2)*(nY-Y)*Zoom),SnowParticles0[t].x>canvas.width+5?SnowParticles0[t].x=-5:SnowParticles0[t].x<-5&&(SnowParticles0[t].x=canvas.width+5),SnowParticles0[t].y>canvas.height+5?SnowParticles0[t].y=-5:SnowParticles0[t].y<-5&&(SnowParticles0[t].y=canvas.height+5),ctx.fillStyle="rgba(255, 255, 255, 0.75)",ctx.beginPath(),ctx.arc(SnowParticles0[t].x,SnowParticles0[t].y,SnowParticles0[t].r,0,2*Math.PI,!0),ctx.closePath(),ctx.fill();for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("Info-2",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("Info-2",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("Info-1",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("Info-1",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("Info",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("Info",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("Info+1",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("Info+1",NoTeamTag(Players[e][0]));for(let e=0;e<Players.length;e++)Players[e][0]==PlayerName?Vehicles[Players[e][1]].drawp("Info+2",NoTeamTag(Players[e][0])):Vehicles[Players[e][1]].draw("Info+2",NoTeamTag(Players[e][0]))}window.requestAnimationFrame(DRAW)}catch(e){window.requestAnimationFrame(DRAW)}}function mousepos(e){mouseX=e.pageX,mouseY=e.pageY}function startgamebtn(){PIXI.sound.stop("MainMenuMusic"),document.getElementById("TitleScreen").classList=["titlescrs"],setTimeout(startgame,1500)}LastAnime=Date.now(),window.requestAnimationFrame(DRAW),window.onload=function(){document.getElementById("TitleScreen").classList=["titlescrh"],GetServerInfo(),navigator.userAgent.match(/iPhone/i)&&document.documentElement.requestFullscreen()};